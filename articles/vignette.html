<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spaSim">
<title>spaSim vignette • spaSim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="spaSim vignette">
<meta property="og:description" content="spaSim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spaSim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette.html">spaSim vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>spaSim vignette</h1>
                        <h4 data-toc-skip class="author">Yuzhou Feng, Anna Trigos</h4>
                        
            <h4 data-toc-skip class="date">26 April 2022</h4>
      
      
      <div class="d-none name"><code>vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="basics">Basics<a class="anchor" aria-label="anchor" href="#basics"></a>
</h2>
<p>spaSim (<strong>spa</strong>tial <strong>Sim</strong>ulator) is a simulator of tumor immune microenvironment spatial data. It includes a family of functions to simulate a diverse set of cell localization patterns in tissues. Patterns include background cells (one cell type or multiple cell types of different proportions), tumour/immune clusters, immune rings and double immune rings and stripes (blood/lymphatic vessels).</p>
<p>As quantitative tools for spatial tissue image analysis have been developed and need benchmarking, simulations from spaSim can be applied to test and benchmark these tools and metrics. The output of spaSim are images in SingleCellExperiment object format and can be used with SPIAT (SPIAT (<strong>Sp</strong>atial <strong>I</strong>mage <strong>A</strong>nalysis of <strong>T</strong>issues) also developed by our team.</p>
<div class="section level3">
<h3 id="installing-spasim">Installing <code>spaSim</code><a class="anchor" aria-label="anchor" href="#installing-spasim"></a>
</h3>
<p><em><a href="https://bioconductor.org/packages/3.15/spaSim" class="external-link">spaSim</a></em> is a <code>R</code> package available via the <a href="http://bioconductor.org" class="external-link">Bioconductor</a> repository for packages. You can install the lasted development version from Github. You can install spaSim using the following commands in your <code>R</code> session:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Check that you have a valid Bioconductor installation</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/valid.html" class="external-link">valid</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
  <span class="op">}</span>

<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"spaSim"</span><span class="op">)</span>

<span class="co"># install from GitHub</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"TrigosTeam/spaSim"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="citing-spasim">Citing <code>spaSim</code><a class="anchor" aria-label="anchor" href="#citing-spasim"></a>
</h3>
<p>We hope that <em><a href="https://bioconductor.org/packages/3.15/spaSim" class="external-link">spaSim</a></em> will be useful for your research. Please use the following information to cite the package and the overall approach. Thank you!</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Citation info</span>
<span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"spaSim"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To cite package 'spaSim' in publications use:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Feng Y, Trigos A (2022). _spaSim: Spatial point data simulator for</span>
<span class="co">#&gt;   tissue images_. R package version 0.99.1,</span>
<span class="co">#&gt;   &lt;https://trigosteam.github.io/spaSim/&gt;.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A BibTeX entry for LaTeX users is</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   @Manual{,</span>
<span class="co">#&gt;     title = {spaSim: Spatial point data simulator for tissue images},</span>
<span class="co">#&gt;     author = {Yuzhou Feng and Anna Trigos},</span>
<span class="co">#&gt;     year = {2022},</span>
<span class="co">#&gt;     note = {R package version 0.99.1},</span>
<span class="co">#&gt;     url = {https://trigosteam.github.io/spaSim/},</span>
<span class="co">#&gt;   }</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start-to-using-spasim">Quick start to using <code>spaSim</code><a class="anchor" aria-label="anchor" href="#quick-start-to-using-spasim"></a>
</h2>
<p>First attach the package</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://trigosteam.github.io/spaSim/">spaSim</a></span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="simulate-an-individual-image">Simulate an individual image<a class="anchor" aria-label="anchor" href="#simulate-an-individual-image"></a>
</h3>
<p>In spaSim, spatial patterns are simulated on separate layers sequentially starting from ‘background cells’ which serve as the canvas for higher order structures (e.g. tumour clusters, immune clusters and immune rings can be simulated after/on top of background cells). Here we will go through each of these steps.</p>
<div class="section level4">
<h4 id="simulate-background-cells">Simulate background cells<a class="anchor" aria-label="anchor" href="#simulate-background-cells"></a>
</h4>
<p>First we randomly generate the spatial locations of generic ‘background cells’ (without cell identities). The ‘background cells’ will serve as the input to the other simulation functions shown below which can assign new identities to these cells in a structured or unstructured way.</p>
<p>Background images are simulated with a Hardcore Process, which is a Poisson process where events (i.e. cells) are maintained at a specific minimum distance from each other. As <code>rHardcore</code> from <code>spatstat.random</code> package deletes cells based on this requirement, our function uses a <code>oversampling_rate</code> to create more cells than the target number of cells (<code>n_cells</code>) to ensure the resulting image has the number of cells specified. If the resulting image ends up with slightly fewer cells than specified, increase the <code>oversampling_rate</code> argument to account for this.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">610</span><span class="op">)</span>
<span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_background_cells.html">simulate_background_cells</a></span><span class="op">(</span>n_cells <span class="op">=</span> <span class="fl">5000</span>,
                                width <span class="op">=</span> <span class="fl">2000</span>,
                                height <span class="op">=</span> <span class="fl">2000</span>,
                                min_d <span class="op">=</span> <span class="fl">10</span>,
                                oversampling_rate <span class="op">=</span> <span class="fl">1.6</span>,
                                Phenotype<span class="op">=</span><span class="st">"Others"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-2-1.png" width="75%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bg</span><span class="op">)</span>
<span class="co">#&gt;           Cell.X.Position Cell.Y.Position Phenotype</span>
<span class="co">#&gt; Cell_55          156.3994        349.0815    Others</span>
<span class="co">#&gt; Cell_2226        878.6766        633.4749    Others</span>
<span class="co">#&gt; Cell_1113        569.0253        489.3713    Others</span>
<span class="co">#&gt; Cell_4788       1996.0439        292.1873    Others</span>
<span class="co">#&gt; Cell_4600       1756.8683       1608.0244    Others</span>
<span class="co">#&gt; Cell_951         306.1119       1641.1277    Others</span>
<span class="co"># use dim(bg)[1] to check if the same number of cells are simulated. </span>
<span class="co"># if not, increase `oversampling_rate`</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bg</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 5000</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="simulate-mixed-background">Simulate mixed background<a class="anchor" aria-label="anchor" href="#simulate-mixed-background"></a>
</h4>
<p>To randomly assign ‘background cells’ to the the specified cell identities in the specified proportions in an unstructured manner, spaSim includes the <code>simulate_mixing</code> function.</p>
<p>Users can use the background image they defined earlier (e.g. <code>bg</code>), or the image predefined in the package (<code>bg1</code>) as the ‘background cells’ to further construct the mixed cell identities. In this example, we use <code>bg</code> that was defined in the previous section.</p>
<p>The <code>props</code> argument defines the proportions of each cell type in <code>idents</code>. Although the proportions are specified, the exact cells that are assigned by each identity are stochastic. Therefore, users are encouraged to use the set.seed() function to ensure reproducibility.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mix_bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_mixing.html">simulate_mixing</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg</span>,
                          idents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                          props <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span><span class="op">)</span>, 
                          plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
                          plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"darkgreen"</span>,<span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-3-1.png" width="75%"></p>
</div>
<div class="section level4">
<h4 id="simulate-clusters">Simulate clusters<a class="anchor" aria-label="anchor" href="#simulate-clusters"></a>
</h4>
<p>This function aims to simulate cells that aggregate as clusters like tumour clusters or immune clusters. Tumour clusters can be circles or ovals (or merging several ovals/circles together), and immune clusters are irregular (or merging several irregular shapes together).</p>
<p>First, we specify the properties of clusters such their primary cell type, size, shape and location. If infiltrating cell types are required, we can also include their properties.</p>
<p>If there are multiple cell types lying in the cluster (e.g. tumour cells and infiltrating cells), the assignment of identities to these cells is random, using the random number sampling technique.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cluster_properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  C1 <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">500</span>, shape <span class="op">=</span> <span class="st">"Oval"</span>, 
           centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">600</span>, y <span class="op">=</span> <span class="fl">600</span><span class="op">)</span>,infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
           infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>, 
  C2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Immune1"</span>, size <span class="op">=</span> <span class="fl">600</span>,  shape <span class="op">=</span> <span class="st">"Irregular"</span>, 
            centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1500</span>, y <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>, infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>,
            infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># can use any defined image as background image, here we use mix_bg defined in the previous section</span>
<span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_clusters.html">simulate_clusters</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">mix_bg</span>,
                              n_clusters <span class="op">=</span> <span class="fl">2</span>,
                              bg_type <span class="op">=</span> <span class="st">"Others"</span>,
                              win <span class="op">=</span> <span class="cn">NULL</span>,
                              cluster_properties <span class="op">=</span> <span class="va">cluster_properties</span>,
                              plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
                              plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span> , <span class="st">"Immune"</span>, <span class="st">"Immune1"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                              plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-4-1.png" width="75%"></p>
<p>The simulated image shows a tumour cluster and an immune cluster on a mixed background image. The primary cell type of the tumour cluster is “Tumour”, with some “Immune1” and “Others” cells also within the tumour cluster. The primary cell type of the immune cluster is “Immune1”, with some “Immune2” and “Others” cells also within the immune cluster.</p>
</div>
<div class="section level4">
<h4 id="simulate-immune-rings">Simulate immune rings<a class="anchor" aria-label="anchor" href="#simulate-immune-rings"></a>
</h4>
<p>This function aims to simulate tumour clusters and an immune ring surrounding each of the clusters, which represent immune cells excluded to the tumor margin.</p>
<p>First, we specify the properties of immune rings such their primary (inner cluster) and secondary (outer ring) cell types, size, shape, width and location. Properties of cells infiltrating into the inner mass or outer ring can also be set.</p>
<p>If there are multiple cell types lying in the cluster and the immune ring, the assignment of identities to these cells is random, using the random number sampling technique.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">immune_ring_properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  I1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">500</span>, 
            shape <span class="op">=</span> <span class="st">"Circle"</span>, centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">930</span>, y <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>, 
            infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
            infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,
            name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">150</span>,
            immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
            immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">rings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_immune_rings.html">simulate_immune_rings</a></span><span class="op">(</span>
  bg_sample <span class="op">=</span> <span class="va">bg</span>,
  bg_type <span class="op">=</span> <span class="st">"Others"</span>,
  n_ir <span class="op">=</span> <span class="fl">1</span>,
  win <span class="op">=</span> <span class="cn">NULL</span>,
  ir_properties <span class="op">=</span> <span class="va">immune_ring_properties</span>,
  plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
  plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>,
  plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-5-1.png" width="75%"></p>
<p>spaSim also allows simulation of two shapes overlapping each other. An algorithm is then used to make the inner mass and outer rings of the different shapes cohesive. An example is shown below. Overlapping of shapes is also possible for clusters and double rings.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">immune_ring_properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> 
  I1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">500</span>, 
            shape <span class="op">=</span> <span class="st">"Circle"</span>, centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">930</span>, y <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>, 
            infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
            infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,
            name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">150</span>,
            immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
            immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>, 
  I2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">400</span>, shape <span class="op">=</span> <span class="st">"Oval"</span>,
           centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1330</span>, y <span class="op">=</span> <span class="fl">1100</span><span class="op">)</span>, 
           infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>,  <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
           infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,
           name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">150</span>,
           immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune2"</span>,<span class="st">"Others"</span><span class="op">)</span>, 
           immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">rings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_immune_rings.html">simulate_immune_rings</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg</span>,
                              bg_type <span class="op">=</span> <span class="st">"Others"</span>,
                              n_ir <span class="op">=</span> <span class="fl">2</span>,
                              win <span class="op">=</span> <span class="cn">NULL</span>,
                              ir_properties <span class="op">=</span> <span class="va">immune_ring_properties</span>,
                              plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
                              plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                              plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-6-1.png" width="75%"></p>
</div>
<div class="section level4">
<h4 id="simulate-double-rings">Simulate double rings<a class="anchor" aria-label="anchor" href="#simulate-double-rings"></a>
</h4>
<p>This function aims to simulate tumour clusters with an inner ring (internal tumour margin) and an outer ring (external tumour margin).</p>
<p>First, we specify the properties of double rings such their primary (inner mass), secondary (inner ring), and tertiary (outer ring) cell types, size, shape, width and location. Properties of cells infiltrating into the inner mass or either ring can also be set. If there are multiple cell types lying in the tumour cluster and the double rings, the assignment of identities to the cells is random, using the random number sampling technique.</p>
<p>Similar to the above case, we are placing two double immune rings that overlap with each other to form a more complex shape.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">double_ring_properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
 I1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">300</span>, shape <span class="op">=</span> <span class="st">"Circle"</span>, 
           centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1000</span>, y <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>, 
           infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
           infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>, 
           name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">80</span>,
           immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
           immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span><span class="op">)</span>, 
           name_of_double_ring_cell <span class="op">=</span> <span class="st">"Immune2"</span>, double_ring_width <span class="op">=</span> <span class="fl">100</span>,
           double_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, 
           double_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>,      
 I2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">300</span>, shape <span class="op">=</span> <span class="st">"Oval"</span>,
           centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1200</span>, y <span class="op">=</span> <span class="fl">1200</span><span class="op">)</span>, 
           infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
           infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,
           name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">80</span>,
           immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>,<span class="st">"Others"</span><span class="op">)</span>, 
           immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.15</span><span class="op">)</span>, 
           name_of_double_ring_cell <span class="op">=</span> <span class="st">"Immune2"</span>, double_ring_width <span class="op">=</span> <span class="fl">100</span>,
           double_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, 
           double_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">double_rings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_double_rings.html">simulate_double_rings</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg1</span>,
                                     bg_type <span class="op">=</span> <span class="st">"Others"</span>,
                                     n_dr <span class="op">=</span> <span class="fl">2</span>,
                                     win <span class="op">=</span> <span class="cn">NULL</span>,
                                     dr_properties <span class="op">=</span> <span class="va">double_ring_properties</span>,
                                     plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
                                     plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                                     plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-7-1.png" width="75%"></p>
<p>The simulated image shows two layers of immune rings. The primary cell type in the inner ring (internal tumour margin) is coloured green, with some “Tumour” cells also lie in the inner ring. The outer ring (external tumour margin) is coloured blue, with some other “Others” cells also lie in the outer ring.</p>
</div>
<div class="section level4">
<h4 id="simulate-vessels">Simulate vessels<a class="anchor" aria-label="anchor" href="#simulate-vessels"></a>
</h4>
<p>This function aims to simulate stripes of cells representing blood/lymphatic vessels. First, we specify the properties of vessel structures such as the number present, their width, and the properties of their infiltrating cells. We then randomly assign ‘background cells’ which lie within these vessel structures to the specified cell identities in the specified proportions.</p>
<p>The locations of the vessels are stochastic.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">properties_of_stripes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
 S1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>number_of_stripes <span class="op">=</span> <span class="fl">1</span>, name_of_stripe_cell <span class="op">=</span> <span class="st">"Immune1"</span>, 
           width_of_stripe <span class="op">=</span> <span class="fl">40</span>, infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>,
           infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span><span class="op">)</span><span class="op">)</span>, 
 S2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>number_of_stripes <span class="op">=</span> <span class="fl">5</span>, name_of_stripe_cell <span class="op">=</span> <span class="st">"Immune2"</span>, 
           width_of_stripe <span class="op">=</span> <span class="fl">40</span>, infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, 
           infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">vessles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_stripes.html">simulate_stripes</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg1</span>,
                           n_stripe_type <span class="op">=</span> <span class="fl">2</span>,
                           win <span class="op">=</span> <span class="cn">NULL</span>,
                           stripe_properties <span class="op">=</span> <span class="va">properties_of_stripes</span>,
                           plot_image <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-8-1.png" width="75%"></p>
</div>
<div class="section level4">
<h4 id="displaying-the-sequential-construction-of-a-simulated-image">Displaying the sequential construction of a simulated image<a class="anchor" aria-label="anchor" href="#displaying-the-sequential-construction-of-a-simulated-image"></a>
</h4>
<p>The <code>TIS</code> (<strong>T</strong>issue <strong>I</strong>mage <strong>S</strong>imulator) function simulates multiple patterns layer by layer and displays the pattern construction sequentially. The patterns are simulated in the order of: background cells, mixed background cells, clusters (tumour/immune), immune rings, double immune rings, and vessels.</p>
<p>Not all patterns are required for using this function. If a pattern is not needed, simply use <code>NULL</code> for the pattern arguments. The example simulates a background sample with a tumour cluster and an immune ring on it (3 patterns: background image -&gt; tumour cluster -&gt; immune ring surrounding tumour cluster).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First specify the cluster and immune ring properties</span>
<span class="co">## tumour cluster properties</span>
<span class="va">properties_of_clusters</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
 C1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">300</span>, shape <span class="op">=</span> <span class="st">"Oval"</span>, 
            centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="fl">500</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,
            infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
            infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">## immune ring properties</span>
<span class="va">immune_ring_properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> 
  I1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">300</span>, 
            shape <span class="op">=</span> <span class="st">"Circle"</span>, centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1030</span>, y <span class="op">=</span> <span class="fl">1100</span><span class="op">)</span>, 
            infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
            infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,
            name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">150</span>,
            immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, 
            immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>, 
  I2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">200</span>, shape <span class="op">=</span> <span class="st">"Oval"</span>,
           centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1430</span>, y <span class="op">=</span> <span class="fl">1400</span><span class="op">)</span>, 
           infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>,  <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, 
           infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,
           name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">150</span>,
           immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, 
           immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># simulation</span>
<span class="co"># no background sample is input, TIS simulates the background cells from scratch</span>
<span class="co"># `n_cells`, `width`, `height`, `min_d` and `oversampling_rate` are parameters for simulating background cells</span>
<span class="co"># `n_clusters`, `properties_of_clusters` are parameters for simulating clusters on top of the background cells</span>
<span class="co"># `plot_image`, `plot_categories`, `plot_colours` are params for plotting</span>
<span class="va">simulated_image</span> <span class="op">&lt;-</span> 
<span class="fu"><a href="../reference/TIS.html">TIS</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="cn">NULL</span>,
   n_cells <span class="op">=</span> <span class="fl">5000</span>,
   width <span class="op">=</span> <span class="fl">2000</span>,
   height <span class="op">=</span> <span class="fl">2000</span>,
   min_d <span class="op">=</span> <span class="fl">10</span>,
   oversampling_rate <span class="op">=</span> <span class="fl">1.6</span>, 
   n_clusters <span class="op">=</span> <span class="fl">1</span>,
   properties_of_clusters <span class="op">=</span> <span class="va">properties_of_clusters</span>,
   n_immune_rings <span class="op">=</span> <span class="fl">2</span>,
   properties_of_immune_rings <span class="op">=</span> <span class="va">immune_ring_properties</span>,
   plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
   plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>,
   plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-9-1.png" width="75%"></p>
<pre><code><span class="co">#&gt; [1] "Immune2 cells were not found and not plotted"</span></code></pre>
<p><img src="vignette_files/figure-html/unnamed-chunk-9-2.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-9-3.png" width="75%"></p>
<p>The results display the construction of a complex image with multiple patterns. It started from a background image with cells of no identities, then tumour a cluster is layered on the background image, and finally, an immune ring that surrounds a tumour cluster is layered on the very top.</p>
</div>
</div>
<div class="section level3">
<h3 id="simulating-a-range-of-multiple-images">Simulating a range of multiple images<a class="anchor" aria-label="anchor" href="#simulating-a-range-of-multiple-images"></a>
</h3>
<p>In some cases simulations of a set of images that span a range of different properties of patterns are needed. Rather than simulating images individually, simulating these images in one go is desirable. The following functions create a quick interface to generate a range of images with different parameters/randomised elements.</p>
<div class="section level4">
<h4 id="simulate-multiple-background-images-multiple-cell-types-with-different-proportions-of-cell-types-">Simulate multiple background images (multiple cell types) with different proportions of cell types.<a class="anchor" aria-label="anchor" href="#simulate-multiple-background-images-multiple-cell-types-with-different-proportions-of-cell-types-"></a>
</h4>
<p>This function aims to simulate a set of images that contain different proportions of specified cell types.</p>
<p>In this example we simulate 4 images with 10% Tumour cells and an increasing number of Immune cells. We first specify the cell types and the proportions of each cell type in each image.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#cell types present in each image</span>
<span class="va">idents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>
<span class="co"># Each vector corresponds to each cell type in `idents`. </span>
<span class="co"># Each element in each vector is the proportion of the cell type in each image.</span>
<span class="co"># (4 images, so 4 elements in each vector)</span>
<span class="va">Tumour_prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span><span class="op">)</span>
<span class="va">Immune_prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">Others_prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span>
<span class="co"># put the proportion vectors in a list</span>
<span class="va">prop_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Tumour_prop</span>, <span class="va">Immune_prop</span>, <span class="va">Others_prop</span><span class="op">)</span>

<span class="co"># simulate </span>
<span class="va">bg_list</span> <span class="op">&lt;-</span> 
 <span class="fu"><a href="../reference/multiple_background_images.html">multiple_background_images</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg</span>, idents <span class="op">=</span> <span class="va">idents</span>, props <span class="op">=</span> <span class="va">prop_list</span>,
                            plot_image <span class="op">=</span> <span class="cn">TRUE</span>, plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; [1] "Immune cells were not found and not plotted"</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-10-1.png" width="75%"></p>
<pre><code><span class="co">#&gt; [1] 2</span></code></pre>
<p><img src="vignette_files/figure-html/unnamed-chunk-10-2.png" width="75%"></p>
<pre><code><span class="co">#&gt; [1] 3</span></code></pre>
<p><img src="vignette_files/figure-html/unnamed-chunk-10-3.png" width="75%"></p>
<pre><code><span class="co">#&gt; [1] 4</span></code></pre>
<p><img src="vignette_files/figure-html/unnamed-chunk-10-4.png" width="75%"></p>
</div>
<div class="section level4">
<h4 id="simulate-multiple-images-with-clusters-of-different-properties-">Simulate multiple images with clusters of different properties.<a class="anchor" aria-label="anchor" href="#simulate-multiple-images-with-clusters-of-different-properties-"></a>
</h4>
<p>This function aims to simulate a set of images that contain different tumour/immune clusters.</p>
<p>Note that in this function users cannot manually define the base shape and the primary cell type of the clusters. There are three options (<code>1</code>, <code>2</code>, and <code>3</code>) for the base shape available in the <code>cluster_shape</code> argument. <code>1</code> for a simple cluster where all cells are “Tumour”, <code>2</code> for a tumour cluster where the primary cell type is “Tumour” and there is infiltration of types “Immune” and “Others”, and <code>3</code> for an immune cluster where the primary cell type is “Immune” and the infiltration cell types are “Immune1” and “Others”.</p>
<p>Here we simulate 4 images with increasing tumour cluster sizes using the cluster shape <code>1</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># if a property is fixed, use a number for that parameter.</span>
<span class="co"># if a property spans a range, use a numeric vector for that parameter, e.g.</span>
<span class="va">range_of_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">500</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">cluster_list</span> <span class="op">&lt;-</span> 
 <span class="fu"><a href="../reference/multiple_images_with_clusters.html">multiple_images_with_clusters</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg1</span>,
                               cluster_shape <span class="op">=</span> <span class="fl">1</span>,
                               prop_infiltration <span class="op">=</span> <span class="fl">0.1</span>,
                               cluster_size <span class="op">=</span> <span class="va">range_of_size</span>,
                               cluster_loc_x <span class="op">=</span> <span class="fl">0</span>,
                               cluster_loc_y <span class="op">=</span> <span class="fl">0</span>,
                               plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
                               plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                               plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-11-1.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-11-2.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-11-3.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-11-4.png" width="75%"></p>
<p>We will also include one example for shape <code>2</code> and one example for shape <code>3</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># shape "2" - Tumour cluster with more and more immune infiltration</span>
<span class="va">range_of_infiltration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="va">cluster_list</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/multiple_images_with_clusters.html">multiple_images_with_clusters</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg1</span>,
                                cluster_shape <span class="op">=</span> <span class="fl">2</span>,
                                prop_infiltration <span class="op">=</span> <span class="va">range_of_infiltration</span>,
                                cluster_size <span class="op">=</span> <span class="fl">200</span>,
                                cluster_loc_x <span class="op">=</span> <span class="fl">0</span>,
                                cluster_loc_y <span class="op">=</span> <span class="fl">0</span>,
                                plot_image <span class="op">=</span> <span class="cn">TRUE</span>, 
                                plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span> , <span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                                plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"darkgreen"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-12-1.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-12-2.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-12-3.png" width="75%"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># shape "3" - Immune cluster</span>
<span class="va">cluster_list</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/multiple_images_with_clusters.html">multiple_images_with_clusters</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg1</span>,
                                 cluster_shape <span class="op">=</span> <span class="fl">3</span>,
                                 prop_infiltration <span class="op">=</span> <span class="fl">0.1</span>,
                                 cluster_size <span class="op">=</span> <span class="fl">500</span>,
                                 cluster_loc_x <span class="op">=</span> <span class="fl">0</span>,
                                 cluster_loc_y <span class="op">=</span> <span class="fl">0</span>,
                                 plot_image <span class="op">=</span> <span class="cn">TRUE</span>, 
                                 plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                                 plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-13-1.png" width="75%"></p>
</div>
<div class="section level4">
<h4 id="simulate-multiple-images-with-immune-rings-of-different-properties">Simulate multiple images with immune rings of different properties<a class="anchor" aria-label="anchor" href="#simulate-multiple-images-with-immune-rings-of-different-properties"></a>
</h4>
<p>This function aims to simulate a set of images that contain different tumour clusters with immune rings.</p>
<p>Note that similar to <code>multiple_images_with_clusters</code>, in this function users cannot manually define the base shape and the primary cell type of the clusters or the immune rings. There are three options for the base shape (<code>1</code>, <code>2</code> and <code>3</code>) available in the <code>ring_shape</code> argument:</p>
<p>For <code>1</code> and <code>2</code>: - primary cluster cell type is “Tumour” - cluster infiltration cell types are “Immune” and “Others” - primary ring cell type is “Immune” - ring infiltration type is “Others”</p>
<p>For <code>3</code>: - primary cluster cell type is “Tumour” - cluster infiltration cell types are “Immune” and “Others” - primary ring cell type is “Immune” - ring infiltration type is “Tumour” and “Others”</p>
<p>The cluster size, infiltration proportions, cluster location, ring width, and ring infiltration proportions can be defined.</p>
<p>Here we show 3 images with increasingly wider immune rings. First define any parameter that has a range.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># if a property is to be fixed, use a number for that parameter.</span>
<span class="co"># if a property is to span a range, use a numeric vector for that parameter, e.g.</span>
<span class="va">range_ring_width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">120</span>, <span class="fl">30</span><span class="op">)</span>

<span class="co"># This example uses ring shape 1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">immune_ring_list</span> <span class="op">&lt;-</span> 
 <span class="fu"><a href="../reference/multiple_images_with_immune_rings.html">multiple_images_with_immune_rings</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg</span>,
                                   cluster_size <span class="op">=</span> <span class="fl">200</span>,
                                   ring_shape <span class="op">=</span> <span class="fl">1</span>,
                                   prop_infiltration <span class="op">=</span> <span class="fl">0</span>,
                                   ring_width <span class="op">=</span> <span class="va">range_ring_width</span>,
                                   cluster_loc_x <span class="op">=</span> <span class="fl">0</span>,
                                   cluster_loc_y <span class="op">=</span> <span class="fl">0</span>,
                                   prop_ring_infiltration <span class="op">=</span> <span class="fl">0.1</span>,
                                   plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
                                   plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                                   plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-14-1.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-14-2.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-14-3.png" width="75%"></p>
<p>We will also include one example for ring shape <code>2</code> and one example for ring shape <code>3</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># shape "2" - Immune ring at different locations</span>
<span class="va">cluster_loc_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">300</span>, <span class="fl">0</span>, <span class="fl">300</span><span class="op">)</span>
<span class="va">cluster_loc_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">300</span>, <span class="fl">0</span>, <span class="fl">300</span><span class="op">)</span>
<span class="va">immune_ring_list</span> <span class="op">&lt;-</span> 
 <span class="fu"><a href="../reference/multiple_images_with_immune_rings.html">multiple_images_with_immune_rings</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg</span>,
                                   cluster_size <span class="op">=</span> <span class="fl">200</span>,
                                   ring_shape <span class="op">=</span> <span class="fl">2</span>,
                                   prop_infiltration <span class="op">=</span> <span class="fl">0</span>,
                                   ring_width <span class="op">=</span> <span class="fl">70</span>,
                                   cluster_loc_x <span class="op">=</span> <span class="va">cluster_loc_x</span>,
                                   cluster_loc_y <span class="op">=</span> <span class="va">cluster_loc_y</span>,
                                   prop_ring_infiltration <span class="op">=</span> <span class="fl">0.1</span>,
                                   plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
                                   plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                                   plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-15-1.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-15-2.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-15-3.png" width="75%"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># shape "3" - Immune ring has different "Tumour" proportions</span>
<span class="va">prop_ring_infiltration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span>
<span class="va">immune_ring_list</span> <span class="op">&lt;-</span> 
 <span class="fu"><a href="../reference/multiple_images_with_immune_rings.html">multiple_images_with_immune_rings</a></span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg</span>,
                                   cluster_size <span class="op">=</span> <span class="fl">200</span>,
                                   ring_shape <span class="op">=</span> <span class="fl">2</span>,
                                   prop_infiltration <span class="op">=</span> <span class="fl">0</span>,
                                   ring_width <span class="op">=</span> <span class="fl">70</span>,
                                   cluster_loc_x <span class="op">=</span> <span class="fl">0</span>,
                                   cluster_loc_y <span class="op">=</span> <span class="fl">0</span>,
                                   prop_ring_infiltration <span class="op">=</span> <span class="va">prop_ring_infiltration</span>,
                                   plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
                                   plot_categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumour"</span>, <span class="st">"Immune"</span>, <span class="st">"Others"</span><span class="op">)</span>,
                                   plot_colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgreen"</span>, <span class="st">"lightgray"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-16-1.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-16-2.png" width="75%"><img src="vignette_files/figure-html/unnamed-chunk-16-3.png" width="75%"></p>
</div>
</div>
<div class="section level3">
<h3 id="input-simulated-images-into-spiat-package-">Input simulated images into <em><a href="https://bioconductor.org/packages/3.15/SPIAT" class="external-link">SPIAT</a></em> package.<a class="anchor" aria-label="anchor" href="#input-simulated-images-into-spiat-package-"></a>
</h3>
<p>As <code>SPIAT</code> uses SingleCellExperiment object as the basic data structure for image processing and analysis, the simulated images from <code>spaSim</code> can be directly used as input in <code>SPIAT</code> functions. Examples in <code>SPIAT</code> packages use the images simulated by <code>spaSim</code>.</p>
<p>Here is an example of using <code>SPIAT</code> function on <code>spaSim</code> image. We use <code>simulated_image</code> generated from one of the previous sections.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The following code will not run as SPIAT is still not released yet. You can try out the dev version on Github~</span>
<span class="co"># if (requireNamespace("SPIAT", quietly = TRUE)) {</span>
<span class="co">#   # visualise</span>
<span class="co">#   SPIAT::plot_cell_categories(sce_object = simulated_image, </span>
<span class="co">#                               categories_of_interest = c("Tumour", "Immune1", "Immune2", "Others"),</span>
<span class="co">#                               colour_vector = c("red", "darkgreen", "darkblue", "lightgray"),</span>
<span class="co">#                               feature_colname = "Phenotype")</span>
<span class="co">#   # calculate average minimum distance of the cells</span>
<span class="co">#   SPIAT::average_minimum_distance(sce_object = simulated_image)</span>
<span class="co">#   # You can also try other functions :)</span>
<span class="co"># }</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Here is an example of you can cite the package.</p>
<ul>
<li>
<em><a href="https://bioconductor.org/packages/3.15/spaSim" class="external-link">spaSim</a></em> (Feng and Trigos, 2022)</li>
</ul>
</div>
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<p>The <em><a href="https://bioconductor.org/packages/3.15/spaSim" class="external-link">spaSim</a></em> package (Feng and Trigos, 2022) was made possible thanks to:</p>
<ul>
<li>R (R Core Team, 2022)</li>
<li>
<em><a href="https://bioconductor.org/packages/3.15/BiocStyle" class="external-link">BiocStyle</a></em> (Oleś, 2021)</li>
<li>
<em><a href="https://CRAN.R-project.org/package=knitr" class="external-link">knitr</a></em> (Xie, 2022)</li>
<li>
<em><a href="https://CRAN.R-project.org/package=RefManageR" class="external-link">RefManageR</a></em> (McLean, 2017)</li>
<li>
<em><a href="https://CRAN.R-project.org/package=rmarkdown" class="external-link">rmarkdown</a></em> (Allaire, Xie, McPherson, Luraschi, Ushey, Atkins, Wickham, Cheng, Chang, and Iannone, 2022)</li>
<li>
<em><a href="https://CRAN.R-project.org/package=sessioninfo" class="external-link">sessioninfo</a></em> (Wickham, Chang, Flight, Müller, and Hester, 2021)</li>
<li>
<em><a href="https://CRAN.R-project.org/package=testthat" class="external-link">testthat</a></em> (Wickham, 2011)</li>
</ul>
<p>This package was developed using <em><a href="https://bioconductor.org/packages/3.15/biocthis" class="external-link">biocthis</a></em>.</p>
<p>Code for creating the vignette</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create the vignette</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/rstudio/rmarkdown" class="external-link">"rmarkdown"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"vignette.Rmd"</span>, <span class="st">"BiocStyle::html_document"</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Extract the R code</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://yihui.org/knitr/" class="external-link">"knitr"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/knit.html" class="external-link">knit</a></span><span class="op">(</span><span class="st">"vignette.Rmd"</span>, tangle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Date the vignette was generated.</p>
<pre><code><span class="co">#&gt; [1] "2022-04-26 12:08:30 UTC"</span></code></pre>
<p>Wallclock time spent generating the vignette.</p>
<pre><code><span class="co">#&gt; Time difference of 1.602 mins</span></code></pre>
<p><code>R</code> session information.</p>
<pre><code><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span>
<span class="co">#&gt;  version  R version 4.2.0 (2022-04-22)</span>
<span class="co">#&gt;  os       Ubuntu 20.04.4 LTS</span>
<span class="co">#&gt;  system   x86_64, linux-gnu</span>
<span class="co">#&gt;  ui       X11</span>
<span class="co">#&gt;  language en</span>
<span class="co">#&gt;  collate  C.UTF-8</span>
<span class="co">#&gt;  ctype    C.UTF-8</span>
<span class="co">#&gt;  tz       UTC</span>
<span class="co">#&gt;  date     2022-04-26</span>
<span class="co">#&gt;  pandoc   2.7.3 @ /usr/bin/ (via rmarkdown)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package             </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span>
<span class="co">#&gt;  Biobase                2.55.2   <span style="color: #555555;">2022-04-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  BiocGenerics           0.41.2   <span style="color: #555555;">2021-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  BiocManager            1.30.17  <span style="color: #555555;">2022-04-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  BiocStyle            * 2.23.1   <span style="color: #555555;">2021-12-17</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  bitops                 1.0-7    <span style="color: #555555;">2021-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  bookdown               0.26     <span style="color: #555555;">2022-04-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  bslib                  0.3.1    <span style="color: #555555;">2021-10-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  cachem                 1.0.6    <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  cli                    3.3.0    <span style="color: #555555;">2022-04-25</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.2.0)</span></span>
<span class="co">#&gt;  colorspace             2.0-3    <span style="color: #555555;">2022-02-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  crayon                 1.5.1    <span style="color: #555555;">2022-03-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  DelayedArray           0.21.2   <span style="color: #555555;">2021-11-16</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  deldir                 1.0-6    <span style="color: #555555;">2021-10-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  desc                   1.4.1    <span style="color: #555555;">2022-03-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  digest                 0.6.29   <span style="color: #555555;">2021-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  dplyr                  1.0.8    <span style="color: #555555;">2022-02-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  ellipsis               0.3.2    <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  evaluate               0.15     <span style="color: #555555;">2022-02-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  fansi                  1.0.3    <span style="color: #555555;">2022-03-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  farver                 2.1.0    <span style="color: #555555;">2021-02-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  fastmap                1.1.0    <span style="color: #555555;">2021-01-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  fs                     1.5.2    <span style="color: #555555;">2021-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  generics               0.1.2    <span style="color: #555555;">2022-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  GenomeInfoDb           1.31.10  <span style="color: #555555;">2022-04-21</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  GenomeInfoDbData       1.2.8    <span style="color: #555555;">2022-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  GenomicRanges          1.47.6   <span style="color: #555555;">2022-01-12</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  ggplot2                3.3.5    <span style="color: #555555;">2021-06-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  glue                   1.6.2    <span style="color: #555555;">2022-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  gtable                 0.3.0    <span style="color: #555555;">2019-03-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  highr                  0.9      <span style="color: #555555;">2021-04-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  htmltools              0.5.2    <span style="color: #555555;">2021-08-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  httr                   1.4.2    <span style="color: #555555;">2020-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  IRanges                2.29.1   <span style="color: #555555;">2021-11-16</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  jquerylib              0.1.4    <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  jsonlite               1.8.0    <span style="color: #555555;">2022-02-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  knitr                  1.38     <span style="color: #555555;">2022-03-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  labeling               0.4.2    <span style="color: #555555;">2020-10-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  lattice                0.20-45  <span style="color: #555555;">2021-09-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.2.0)</span></span>
<span class="co">#&gt;  lifecycle              1.0.1    <span style="color: #555555;">2021-09-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  lubridate              1.8.0    <span style="color: #555555;">2021-10-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  magrittr               2.0.3    <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  Matrix                 1.4-1    <span style="color: #555555;">2022-03-23</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.2.0)</span></span>
<span class="co">#&gt;  MatrixGenerics         1.7.0    <span style="color: #555555;">2021-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  matrixStats            0.62.0   <span style="color: #555555;">2022-04-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  memoise                2.0.1    <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  munsell                0.5.0    <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  pillar                 1.7.0    <span style="color: #555555;">2022-02-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  pkgconfig              2.0.3    <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  pkgdown                2.0.3    <span style="color: #555555;">2022-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  plyr                   1.8.7    <span style="color: #555555;">2022-03-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  polyclip               1.10-0   <span style="color: #555555;">2019-03-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  purrr                  0.3.4    <span style="color: #555555;">2020-04-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  R6                     2.5.1    <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  ragg                   1.2.2    <span style="color: #555555;">2022-02-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  Rcpp                   1.0.8.3  <span style="color: #555555;">2022-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  RCurl                  1.98-1.6 <span style="color: #555555;">2022-02-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  RefManageR           * 1.3.0    <span style="color: #555555;">2020-11-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  rlang                  1.0.2    <span style="color: #555555;">2022-03-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  rmarkdown              2.14     <span style="color: #555555;">2022-04-25</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">CRAN (R 4.2.0)</span></span>
<span class="co">#&gt;  rprojroot              2.0.3    <span style="color: #555555;">2022-04-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  S4Vectors              0.33.17  <span style="color: #555555;">2022-04-06</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  sass                   0.4.1    <span style="color: #555555;">2022-03-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  scales                 1.2.0    <span style="color: #555555;">2022-04-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  sessioninfo          * 1.2.2    <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  SingleCellExperiment   1.17.2   <span style="color: #555555;">2021-11-18</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  spaSim               * 0.99.1   <span style="color: #555555;">2022-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span>
<span class="co">#&gt;  spatstat.data          2.2-0    <span style="color: #555555;">2022-04-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  spatstat.geom          2.4-0    <span style="color: #555555;">2022-03-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  spatstat.random        2.2-0    <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  spatstat.utils         2.3-0    <span style="color: #555555;">2021-12-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  stringi                1.7.6    <span style="color: #555555;">2021-11-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  stringr                1.4.0    <span style="color: #555555;">2019-02-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  SummarizedExperiment   1.25.3   <span style="color: #555555;">2021-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  systemfonts            1.0.4    <span style="color: #555555;">2022-02-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  textshaping            0.3.6    <span style="color: #555555;">2021-10-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  tibble                 3.1.6    <span style="color: #555555;">2021-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  tidyselect             1.1.2    <span style="color: #555555;">2022-02-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  utf8                   1.2.2    <span style="color: #555555;">2021-07-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  vctrs                  0.4.1    <span style="color: #555555;">2022-04-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  xfun                   0.30     <span style="color: #555555;">2022-03-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  xml2                   1.3.3    <span style="color: #555555;">2021-11-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  XVector                0.35.0   <span style="color: #555555;">2021-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt;  yaml                   2.3.5    <span style="color: #555555;">2022-02-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span>
<span class="co">#&gt;  zlibbioc               1.41.0   <span style="color: #555555;">2021-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #555555;"> [1] /home/runner/work/_temp/Library</span></span>
<span class="co">#&gt; <span style="color: #555555;"> [2] /opt/R/4.2.0/lib/R/library</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<p>This vignette was generated using <em><a href="https://bioconductor.org/packages/3.15/BiocStyle" class="external-link">BiocStyle</a></em> (Oleś, 2021) with <em><a href="https://CRAN.R-project.org/package=knitr" class="external-link">knitr</a></em> (Xie, 2022) and <em><a href="https://CRAN.R-project.org/package=rmarkdown" class="external-link">rmarkdown</a></em> (Allaire, Xie, McPherson, et al., 2022) running behind the scenes.Citations made with <em><a href="https://CRAN.R-project.org/package=RefManageR" class="external-link">RefManageR</a></em> (McLean, 2017).</p>
<p>
<a id="bib-allaire2022rmarkdown"></a><a href="#cite-allaire2022rmarkdown">[1]</a><cite> J. Allaire, Y. Xie, J. McPherson, et al. <em>rmarkdown: Dynamic Documents for R</em>. R package version 2.14. 2022. URL: <a href="https://github.com/rstudio/rmarkdown" class="external-link">https://github.com/rstudio/rmarkdown</a>.</cite>
</p>
<p>
<a id="bib-feng2022spasim"></a><a href="#cite-feng2022spasim">[2]</a><cite> Y. Feng and A. Trigos. <em>spaSim: Spatial point data simulator for tissue images</em>. R package version 0.99.1. 2022. URL: <a href="https://trigosteam.github.io/spaSim/">https://trigosteam.github.io/spaSim/</a>.</cite>
</p>
<p>
<a id="bib-mclean2017refmanager"></a><a href="#cite-mclean2017refmanager">[3]</a><cite> M. W. McLean. “RefManageR: Import and Manage BibTeX and BibLaTeX References in R”. In: <em>The Journal of Open Source Software</em> (2017). DOI: <a href="https://doi.org/10.21105/joss.00338" class="external-link">10.21105/joss.00338</a>.</cite>
</p>
<p>
<a id="bib-ole2021biocstyle"></a><a href="#cite-ole2021biocstyle">[4]</a><cite> A. Oleś. <em>BiocStyle: Standard styles for vignettes and other Bioconductor documents</em>. R package version 2.23.1. 2021. URL: <a href="https://github.com/Bioconductor/BiocStyle" class="external-link">https://github.com/Bioconductor/BiocStyle</a>.</cite>
</p>
<p>
<a id="bib-2022language"></a><a href="#cite-2022language">[5]</a><cite> R Core Team. <em>R: A Language and Environment for Statistical Computing</em>. R Foundation for Statistical Computing. Vienna, Austria, 2022. URL: <a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.</cite>
</p>
<p>
<a id="bib-wickham2011testthat"></a><a href="#cite-wickham2011testthat">[6]</a><cite> H. Wickham. “testthat: Get Started with Testing”. In: <em>The R Journal</em> 3 (2011), pp. 5–10. URL: <a href="https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf" class="external-link">https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Wickham.pdf</a>.</cite>
</p>
<p>
<a id="bib-wickham2021sessioninfo"></a><a href="#cite-wickham2021sessioninfo">[7]</a><cite> H. Wickham, W. Chang, R. Flight, et al. <em>sessioninfo: R Session Information</em>. <a href="https://github.com/r-lib/sessioninfo#readme" class="external-link uri">https://github.com/r-lib/sessioninfo#readme</a>, <a href="https://r-lib.github.io/sessioninfo/" class="external-link uri">https://r-lib.github.io/sessioninfo/</a>. 2021.</cite>
</p>
<p>
<a id="bib-xie2022knitr"></a><a href="#cite-xie2022knitr">[8]</a><cite> Y. Xie. <em>knitr: A General-Purpose Package for Dynamic Report Generation in R</em>. R package version 1.38. 2022. URL: <a href="https://yihui.org/knitr/" class="external-link">https://yihui.org/knitr/</a>.</cite>
</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yuzhou Feng, Anna Trigos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
