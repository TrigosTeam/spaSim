<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate clusters — simulate_clusters • spaSim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate clusters — simulate_clusters"><meta property="og:description" content="Based on an existing background image, simulate clusters of
cells where the same type of cells aggregate. The default values for the
arguments give an example of cluster simulation which enable an automatic
simulation of clusters without the specification of any argument."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spaSim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/vignette.html">spaSim vignette</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate clusters</h1>
    
    <div class="hidden name"><code>simulate_clusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Based on an existing background image, simulate clusters of
cells where the same type of cells aggregate. The default values for the
arguments give an example of cluster simulation which enable an automatic
simulation of clusters without the specification of any argument.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulate_clusters</span><span class="op">(</span></span>
<span>  bg_sample <span class="op">=</span> <span class="va">bg1</span>,</span>
<span>  n_clusters <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  bg_type <span class="op">=</span> <span class="st">"Others"</span>,</span>
<span>  cluster_properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>C1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    shape <span class="op">=</span> <span class="st">"Oval"</span>, centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">500</span>, y <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>, infiltration_types <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Others"</span><span class="op">)</span>, infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>, C2 <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Immune1"</span>, size <span class="op">=</span> <span class="fl">500</span>, shape <span class="op">=</span> <span class="st">"Irregular"</span>, centre_loc <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1500</span>, y <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>, infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>,</span>
<span>    infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  plot_image <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_categories <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_colours <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bg_sample</dt>
<dd><p>(OPTIONAL) A data frame or <code>SpatialExperiment</code> class object
with locations of points representing background cells. Further cell types
will be simulated based on this background sample. The data.frame or the
<code>spatialCoords()</code> of the SPE object should have colnames including
"Cell.X.Positions" and "Cell.Y.Positions". By default use the internal
<code><a href="bg1.html">bg1</a></code> background image.</p></dd>


<dt>n_clusters</dt>
<dd><p>Numeric. Number of clusters. This must match the
<code>length(cluster_properties)</code>.</p></dd>


<dt>bg_type</dt>
<dd><p>(OPTIONAL) String. The name of the background cell type if the
background sample does not have a "Cell.Type" column. By default is
"Others".</p></dd>


<dt>cluster_properties</dt>
<dd><p>List of properties of the clusters. See examples
for the format of this arg.</p></dd>


<dt>plot_image</dt>
<dd><p>Boolean. Whether the simulated image is plotted.</p></dd>


<dt>plot_categories</dt>
<dd><p>String Vector specifying the order of the cell
categories to be plotted. Default is NULL - the cell categories under the
"Cell.Type" column would be used for plotting.</p></dd>


<dt>plot_colours</dt>
<dd><p>String Vector specifying the order of the colours that
correspond to the <code>plot_categories</code> arg. Default is NULL - the predefined
colour vector would be used for plotting.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data.frame of the simulated image</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="simulate_background_cells.html">simulate_background_cells</a></code> for all cell simulation,
<code><a href="simulate_mixing.html">simulate_mixing</a></code> for mixed background simulation,
<code><a href="simulate_immune_rings.html">simulate_immune_rings</a></code>/<code><a href="simulate_double_rings.html">simulate_double_rings</a></code> for
immune ring simulation, and <code><a href="simulate_stripes.html">simulate_stripes</a></code> for vessel
simulation.</p>
<p>Other simulate pattern functions: 
<code><a href="simulate_background_cells.html">simulate_background_cells</a>()</code>,
<code><a href="simulate_double_rings.html">simulate_double_rings</a>()</code>,
<code><a href="simulate_immune_rings.html">simulate_immune_rings</a>()</code>,
<code><a href="simulate_mixing.html">simulate_mixing</a>()</code>,
<code><a href="simulate_stripes.html">simulate_stripes</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">610</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cluster_image</span> <span class="op">&lt;-</span> <span class="fu">simulate_clusters</span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg1</span>,</span></span>
<span class="r-in"><span>n_clusters<span class="op">=</span><span class="fl">2</span>, cluster_properties<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>C1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell<span class="op">=</span><span class="st">"Tumour"</span>,</span></span>
<span class="r-in"><span>size<span class="op">=</span><span class="fl">300</span>, shape<span class="op">=</span><span class="st">"Oval"</span>, centre_loc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">=</span><span class="fl">500</span>, <span class="st">"y"</span><span class="op">=</span><span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>infiltration_types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Others"</span><span class="op">)</span>, infiltration_proportions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>C2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell<span class="op">=</span><span class="st">"Immune1"</span>, size<span class="op">=</span><span class="fl">500</span>, shape<span class="op">=</span><span class="st">"Irregular"</span>,</span></span>
<span class="r-in"><span>centre_loc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">=</span><span class="fl">1500</span>,<span class="st">"y"</span><span class="op">=</span><span class="fl">500</span><span class="op">)</span>, infiltration_types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>infiltration_proportions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="simulate_clusters-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yuzhou Feng, Anna Trigos.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

