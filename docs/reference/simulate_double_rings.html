<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Based on an existing background image, simulate double rings of
immune cells that surround tumour clusters. The inner ring is the internal
margin of a tumour cluster. The outer ring is the external tumour margin.
The tumour clusters and the double immune rings are simulated at the same
time."><title>Simulate double immune rings — simulate_double_rings • spaSim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate double immune rings — simulate_double_rings"><meta property="og:description" content="Based on an existing background image, simulate double rings of
immune cells that surround tumour clusters. The inner ring is the internal
margin of a tumour cluster. The outer ring is the external tumour margin.
The tumour clusters and the double immune rings are simulated at the same
time."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spaSim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette.html">vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/fuerzhou/spaSim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate double immune rings</h1>
      <small class="dont-index">Source: <a href="https://github.com/fuerzhou/spaSim/blob/HEAD/R/simulate_double_rings.R" class="external-link"><code>R/simulate_double_rings.R</code></a></small>
      <div class="d-none name"><code>simulate_double_rings.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Based on an existing background image, simulate double rings of
immune cells that surround tumour clusters. The inner ring is the internal
margin of a tumour cluster. The outer ring is the external tumour margin.
The tumour clusters and the double immune rings are simulated at the same
time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">simulate_double_rings</span><span class="op">(</span>
  bg_sample <span class="op">=</span> <span class="va">bg1</span>,
  bg_type <span class="op">=</span> <span class="st">"Others"</span>,
  n_dr <span class="op">=</span> <span class="fl">2</span>,
  win <span class="op">=</span> <span class="cn">NULL</span>,
  dr_properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>I1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">300</span>, shape <span class="op">=</span>
    <span class="st">"Circle"</span>, centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1000</span>, y <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>, infiltration_types <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,
    name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">150</span>,
    immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, immune_ring_infiltration_proportions <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span>, name_of_double_ring_cell <span class="op">=</span> <span class="st">"Immune2"</span>, double_ring_width <span class="op">=</span> <span class="fl">100</span>,
    double_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, double_ring_infiltration_proportions <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>,      I2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>, size <span class="op">=</span> <span class="fl">300</span>, shape <span class="op">=</span> <span class="st">"Oval"</span>,
    centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1200</span>, y <span class="op">=</span> <span class="fl">1200</span><span class="op">)</span>, infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>,
    <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>, infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,
    name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>, immune_ring_width <span class="op">=</span> <span class="fl">150</span>,
    immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, immune_ring_infiltration_proportions <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span>, name_of_double_ring_cell <span class="op">=</span> <span class="st">"Immune2"</span>, double_ring_width <span class="op">=</span> <span class="fl">100</span>,
    double_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>, double_ring_infiltration_proportions <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  plot_image <span class="op">=</span> <span class="cn">TRUE</span>,
  plot_categories <span class="op">=</span> <span class="cn">NULL</span>,
  plot_colours <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>bg_sample</dt>
<dd><p>(OPTIONAL) A data.frame or SingleCellExperiment class object
with locations of points representing background cells. Further cell types
will be simulated based on this background sample. The data.frame or the
metadata of the SCE object should have colnames including
"Cell.X.Positions" and "Cell.Y.Positions". By default use the internal
<code><a href="bg1.html">bg1</a></code> background image.</p></dd>
<dt>bg_type</dt>
<dd><p>(OPTIONAL) String The name of the background cell type. By
default is "Others".</p></dd>
<dt>n_dr</dt>
<dd><p>Number of double immune rings. This must match the
<code>length(dr_properties)</code>.</p></dd>
<dt>win</dt>
<dd><p>(OPTIONAL) owin object output from spatstat.geom::owin function.
By default is the window of the background image.</p></dd>
<dt>dr_properties</dt>
<dd><p>List of properties of the double immune
rings. Please refer to the examples for the structure of <code>dr_properties</code>.</p></dd>
<dt>plot_image</dt>
<dd><p>Boolean. Whether the simulated image is plotted.</p></dd>
<dt>plot_categories</dt>
<dd><p>String Vector specifying the order of the cell
categories to be plotted.</p></dd>
<dt>plot_colours</dt>
<dd><p>String Vector specifying the order of the colours that
correspond to the <code>plot_categories</code> arg.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame of the simulated image</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="simulate_background_cells.html">simulate_background_cells</a></code> for all cell simulation,
<code><a href="simulate_mixing.html">simulate_mixing</a></code> for mixed background simulation,
<code><a href="simulate_clusters.html">simulate_clusters</a></code> for cluster simulation,
<code><a href="simulate_immune_rings.html">simulate_immune_rings</a></code> for single immune ring simulation, and
<code><a href="simulate_stripes.html">simulate_stripes</a></code> for vessel simulation.</p>
<p>Other simulate pattern functions: 
<code><a href="simulate_background_cells.html">simulate_background_cells</a>()</code>,
<code><a href="simulate_clusters.html">simulate_clusters</a>()</code>,
<code><a href="simulate_immune_rings.html">simulate_immune_rings</a>()</code>,
<code><a href="simulate_mixing.html">simulate_mixing</a>()</code>,
<code><a href="simulate_stripes.html">simulate_stripes</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">610</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># manually define the properties of the immune ring</span></span>
<span class="r-in"><span class="va">dr_properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>D1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>,size <span class="op">=</span> <span class="fl">300</span>,</span>
<span class="r-in">shape <span class="op">=</span> <span class="st">"Circle"</span>,centre_loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,infiltration_types</span>
<span class="r-in"><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>,infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span class="r-in">name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>,immune_ring_width <span class="op">=</span> <span class="fl">150</span>,immune_ring_infiltration_types</span>
<span class="r-in"><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>,immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span>,name_of_double_ring_cell</span>
<span class="r-in"><span class="op">=</span> <span class="st">"Immune2"</span>,double_ring_width <span class="op">=</span> <span class="fl">100</span>,double_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>,</span>
<span class="r-in">double_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">D2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name_of_cluster_cell <span class="op">=</span> <span class="st">"Tumour"</span>,size <span class="op">=</span> <span class="fl">300</span>,shape <span class="op">=</span> <span class="st">"Oval"</span>,centre_loc</span>
<span class="r-in"><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="fl">1200</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="fl">1200</span><span class="op">)</span>,infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Immune1"</span>, <span class="st">"Immune2"</span>, <span class="st">"Others"</span><span class="op">)</span>,</span>
<span class="r-in">infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>,name_of_ring_cell <span class="op">=</span> <span class="st">"Immune1"</span>,</span>
<span class="r-in">immune_ring_width <span class="op">=</span> <span class="fl">150</span>,immune_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>,</span>
<span class="r-in">immune_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span>,name_of_double_ring_cell <span class="op">=</span> <span class="st">"Immune2"</span>,</span>
<span class="r-in">double_ring_width <span class="op">=</span> <span class="fl">100</span>,double_ring_infiltration_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Others"</span><span class="op">)</span>,</span>
<span class="r-in">double_ring_infiltration_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">double_ring_image</span> <span class="op">&lt;-</span> <span class="fu">simulate_double_rings</span><span class="op">(</span>bg_sample <span class="op">=</span> <span class="va">bg1</span>,</span>
<span class="r-in">n_dr <span class="op">=</span> <span class="fl">2</span>, dr_properties <span class="op">=</span> <span class="va">dr_properties</span><span class="op">)</span></span>
<span class="r-plt img"><img src="simulate_double_rings-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yuzhou Feng, Anna Trigos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

